[dotenv@17.2.4] injecting env (0) from src\.env -- tip: ≡ƒöä add secrets lifecycle management: https://dotenvx.com/ops
node.exe : [Prisma] Error loading .env: Error: ENOENT: no such file or directory, open 
'D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\.env'
At C:\nvm4w\nodejs\npx.ps1:29 char:3
+   & $NODE_EXE $NPX_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: ([Prisma] Error ...s\api\src\.env':String) 
    [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
    at Object.readFileSync (node:fs:442:20)
    at Object.configDotenv (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\n
ode_modules\dotenv\lib\main.js:288:44)
    at Object.config (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\node_mo
dules\dotenv\lib\main.js:334:25)
    at dotenv 
(D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\lib\prisma.ts:7:23)
    at Object.<anonymous> 
(D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\lib\prisma.ts:29:16)
    at Module._compile (node:internal/modules/cjs/loader:1554:14)
    at Object.transformer (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_module
s\tsx\dist\register-D46fvsV_.cjs:3:1104)
    at Module.load (node:internal/modules/cjs/loader:1289:32)
    at Function._load (node:internal/modules/cjs/loader:1108:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14) {
  errno: -4058,
  code: 'ENOENT',
  syscall: 'open',
  path: 'D:\\MobileApp\\Chatbot\\chatbot-master\\chatbot-saas\\apps\\api\\src\\.env'
}
[Prisma] Using DATABASE_URL: Γ£à Set
[AI Config] Using embeddings provider: ollama
============================================================
TESTING KNOWLEDGE SERVICE DIRECTLY
============================================================

1. Calling addKnowledge with:
   - tenantId: test-tenant-123
   - content: This is test content
   - source: manual

[KnowledgeService] Adding knowledge for tenant test-tenant-123
[KnowledgeService] Generating embedding for content: "This is test content for debugging the 500 error..."
[KnowledgeService] Embedding generated. Vector length: 768
[KnowledgeService] Saving to database...
prisma:error 
Invalid `prisma.knowledgeChunk.create()` invocation in
D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\services\KnowledgeService.ts:31:55

  28 
  29 // 2. Save Content to Postgres
  30 console.log(`[KnowledgeService] Saving to database...`);
ΓåÆ 31 const chunk = await prisma.knowledgeChunk.create(
Foreign key constraint violated: `KnowledgeChunk_tenantId_fkey (index)`
[KnowledgeService] Error adding knowledge: PrismaClientKnownRequestError: 
Invalid `prisma.knowledgeChunk.create()` invocation in
D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\services\KnowledgeService
.ts:31:55

  28 
  29 // 2. Save Content to Postgres
  30 console.log(`[KnowledgeService] Saving to database...`);
ΓåÆ 31 const chunk = await prisma.knowledgeChunk.create(
Foreign key constraint violated: `KnowledgeChunk_tenantId_fkey (index)`
    at $n.handleRequestError (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_mod
ules\@prisma\client\runtime\library.js:121:7315)
    at $n.handleAndLogRequestError (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\no
de_modules\@prisma\client\runtime\library.js:121:6623)
    at $n.request (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_modules\@prism
a\client\runtime\library.js:121:6307)
    at async l (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_modules\@prisma\c
lient\runtime\library.js:130:9633)
    at async KnowledgeService.addKnowledge (D:\MobileApp\Chatbot\chatbot-master\chatbot
-saas\apps\api\src\services\KnowledgeService.ts:31:27)
    at async testDirectly 
(D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\test_exact_error.ts:14:24) {
  code: 'P2003',
  clientVersion: '5.22.0',
  meta: {
    modelName: 'KnowledgeChunk',
    field_name: 'KnowledgeChunk_tenantId_fkey (index)'
  }
}

============================================================
Γ¥î ERROR CAUGHT - THIS IS THE EXACT PROBLEM:
============================================================

Error Name: PrismaClientKnownRequestError

Error Message: 
Invalid `prisma.knowledgeChunk.create()` invocation in
D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\services\KnowledgeService.ts:31:55

  28 
  29 // 2. Save Content to Postgres
  30 console.log(`[KnowledgeService] Saving to database...`);
ΓåÆ 31 const chunk = await prisma.knowledgeChunk.create(
Foreign key constraint violated: `KnowledgeChunk_tenantId_fkey (index)`

Error Code: P2003

Full Stack Trace:
PrismaClientKnownRequestError: 
Invalid `prisma.knowledgeChunk.create()` invocation in
D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\services\KnowledgeService.ts:31:55

  28 
  29 // 2. Save Content to Postgres
  30 console.log(`[KnowledgeService] Saving to database...`);
ΓåÆ 31 const chunk = await prisma.knowledgeChunk.create(
Foreign key constraint violated: `KnowledgeChunk_tenantId_fkey (index)`
    at $n.handleRequestError (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_modules\@prisma\client\runtime\library.js:121:7315)
    at $n.handleAndLogRequestError (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_modules\@prisma\client\runtime\library.js:121:6623)
    at $n.request (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_modules\@prisma\client\runtime\library.js:121:6307)
    at async l (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\node_modules\@prisma\client\runtime\library.js:130:9633)
    at async KnowledgeService.addKnowledge (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\src\services\KnowledgeService.ts:31:27)
    at async testDirectly (D:\MobileApp\Chatbot\chatbot-master\chatbot-saas\apps\api\test_exact_error.ts:14:24)

============================================================
